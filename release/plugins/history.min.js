/*! history/tQuery v0.1.2 | (c) zhliner@gmail.com 2021.10.20 | MIT License */
this.$=this.$||{},this.$.Fx=this.$.Fx||{},this.$.Fx.History=function(){"use strict";const t=window.$,s={attrdone:t=>g(t.target,t.detail,i),propdone:t=>g(t.target,t.detail,n),styledone:t=>new r(t.target,t.detail),classdone:t=>new a(t.target,t.detail[2]),nodesdone:t=>new o(t.detail[0]),nodeok:t=>new o([t.target]),detach:t=>new c(t.target),emptied:t=>new d(t.target,t.detail),normalize:t=>new u(t.target),bound:t=>new _(t.target,...t.detail),unbound:t=>new l(t.target,...t.detail)};class e{constructor(){this._buf=[]}handleEvent(t){let e=s[t.type](t);e.changed()&&this._buf.push(e),t.stopPropagation()}back(s){s>0&&function(s){let e=t.config({varyevent:null,bindevent:null});try{s()}finally{t.config(e)}}((()=>this._backs(this._buf,s)))}size(){return this._buf.length}prune(t){t>0&&this._buf.splice(0,t)}clear(){this._buf.length=0}_backs(t,s){t.splice(-s).reverse().forEach((t=>t.back()))}}class i{constructor(t,[s,e]){this._el=t,this._name=s,this._old=e}back(){if(null===this._old)return this._el.removeAttribute(this._name);this._el.setAttribute(this._name,this._old)}changed(){return this._el.getAttribute(this._name)!==this._old}}class n{constructor(t,[s,e,i]){this._el=t,this._name=s,this._old=e,this._isdn=i}back(){this._isdn?this._el.dataset[this._name]=this._old:this._el[this._name]=this._old}changed(){return this._isdn?this._el.dataset[this._name]!==this._old:this._el[this._name]!==this._old}}class h{constructor(t,s){this._box=t,this._nds=s}back(){this._box.textContent="",this._box.append(...this._nds)}changed(){return this._nds.length>0||""!==this._box.textContent}}class r{constructor(t,[s,e]){this._el=t,this._name=s,this._old=e}back(){this._el.style[this._name]=this._old,this._el.style.cssText||this._el.removeAttribute("style")}changed(){return this._el.style[this._name]!==this._old}}class a{constructor(t,s){this._el=t,this._ns=s}back(){this._el.removeAttribute("class"),this._ns.length&&this._ns.forEach((t=>this._el.classList.add(t)))}changed(){let t=new Set(this._el.classList);return this._ns.length!==t.size||this._ns.some((s=>!t.has(s)))}}class _{constructor(t,s,e,i,n){this._el=t,this._evn=s,this._slr=e,this._handle=i,this._cap=n}back(){t.off(this._el,this._evn,this._slr,this._handle,this._cap)}changed(){return!0}}class l{constructor(t,s,e,i,n,h){this._el=t,this._evn=s,this._slr=e,this._handle=i,this._cap=n,this._once=h}back(){let s=this._once?"one":"on";t[s](this._el,this._evn,this._slr,this._handle,this._cap)}changed(){return!0}}class o{constructor(t){this._nodes=t}back(){this._nodes.forEach((t=>t.remove()))}changed(){return!0}}class c{constructor(t){this._node=t,this._prev=t.previousSibling,this._box=t.parentNode}back(){if(this._prev)return this._prev.after(this._node);this._box.prepend(this._node)}changed(){return!0}}class d{constructor(t,s){this._box=t,this._data=s}back(){this._data.length>0&&this._box.prepend(...this._data)}changed(){return!0}}class u{constructor(s){let e=t.textNodes(s).filter(((t,s,e)=>{return i=t,n=e[s-1],h=e[s+1],i.previousSibling===n||i.nextSibling===h;var i,n,h}));this._buf=function(t){if(0==t.length)return[];let s=[t.shift()],e=[s];for(const i of t)i.previousSibling!==s[s.length-1]?e.push(s=[i]):s.push(i);return e}(e).map((t=>new b(t)))}back(){this._buf.forEach((t=>t.back()))}changed(){return this._buf.length>0}}class b{constructor(t){let s=t.shift(),e=s.textContent;this._ref=s,this._txt0=e,this._data=t}back(){this._ref.textContent=this._txt0,this._ref.after(...this._data)}}function g(t,s,e){return"text"===s[0]||"html"===s[0]?new h(t,s[1]):new e(t,s)}return e.Normalize=u,e}();
